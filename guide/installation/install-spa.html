<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>安装 SPA 应用（H5） | Plus (ThinkSNS+)</title>
    <meta name="description" content="Plus (ThinkSNS+) 是使用 Laravel 框架开发；一个功能强大、易于开发和动态拓展的社交系统。">
    <link rel="icon" href="https://github.com/slimkit/plus/blob/master/public/favicon.ico?raw=true">
    
    <link rel="preload" href="/plus/assets/css/0.styles.267dea63.css" as="style"><link rel="preload" href="/plus/assets/js/app.d5d27418.js" as="script"><link rel="preload" href="/plus/assets/js/15.a1f97495.js" as="script"><link rel="prefetch" href="/plus/assets/js/10.3434f81e.js"><link rel="prefetch" href="/plus/assets/js/11.62324157.js"><link rel="prefetch" href="/plus/assets/js/12.87521803.js"><link rel="prefetch" href="/plus/assets/js/13.720f8310.js"><link rel="prefetch" href="/plus/assets/js/14.234f9ff5.js"><link rel="prefetch" href="/plus/assets/js/16.16aa3134.js"><link rel="prefetch" href="/plus/assets/js/17.fc1b72ba.js"><link rel="prefetch" href="/plus/assets/js/18.6f8d127f.js"><link rel="prefetch" href="/plus/assets/js/19.b199d23c.js"><link rel="prefetch" href="/plus/assets/js/2.3ca6255a.js"><link rel="prefetch" href="/plus/assets/js/20.f7bde8a7.js"><link rel="prefetch" href="/plus/assets/js/21.f518b4d2.js"><link rel="prefetch" href="/plus/assets/js/22.cf9650d3.js"><link rel="prefetch" href="/plus/assets/js/3.af72940f.js"><link rel="prefetch" href="/plus/assets/js/4.120301cc.js"><link rel="prefetch" href="/plus/assets/js/5.6f61cb50.js"><link rel="prefetch" href="/plus/assets/js/6.e5a1cca8.js"><link rel="prefetch" href="/plus/assets/js/7.edf0da43.js"><link rel="prefetch" href="/plus/assets/js/8.9aa2c322.js"><link rel="prefetch" href="/plus/assets/js/9.6c9a716d.js">
    <link rel="stylesheet" href="/plus/assets/css/0.styles.267dea63.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/plus/" class="home-link router-link-active"><!----> <span class="site-name">Plus (ThinkSNS+)</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">学习指南</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/plus/guide/installation/" class="nav-link router-link-active">安装教程</a></li><li class="dropdown-item"><!----> <a href="/plus/guide/upgrade/" class="nav-link">升级指南</a></li><li class="dropdown-item"><h4>开发教程</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/plus/guide/dev/blog/" class="nav-link">应用开发</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">HTTP APIs</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/plus/core/api/v2/system.html" class="nav-link">核心</a></li><li class="dropdown-item"><!----> <a href="/plus/api-v2/user/" class="nav-link">用户</a></li></ul></div></div> <a href="https://github.com/slimkit/plus" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">学习指南</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/plus/guide/installation/" class="nav-link router-link-active">安装教程</a></li><li class="dropdown-item"><!----> <a href="/plus/guide/upgrade/" class="nav-link">升级指南</a></li><li class="dropdown-item"><h4>开发教程</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/plus/guide/dev/blog/" class="nav-link">应用开发</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">HTTP APIs</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/plus/core/api/v2/system.html" class="nav-link">核心</a></li><li class="dropdown-item"><!----> <a href="/plus/api-v2/user/" class="nav-link">用户</a></li></ul></div></div> <a href="https://github.com/slimkit/plus" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/plus/guide/installation/" class="sidebar-link">概述</a></li><li><a href="/plus/guide/installation/build-install-php.html" class="sidebar-link">安装 PHP</a></li><li><a href="/plus/guide/installation/build-install-mysql.html" class="sidebar-link">安装 MySQL</a></li><li><a href="/plus/guide/installation/build-install-nginx.html" class="sidebar-link">安装 Nginx</a></li><li><a href="/plus/guide/installation/install-plus.html" class="sidebar-link">安装 Plus</a></li><li><a href="/plus/guide/installation/using-nginx-and-fpm-publish-website.html" class="sidebar-link">使用 Nginx + FPM 发布站点</a></li><li><a href="/plus/guide/installation/install-spa.html" class="active sidebar-link">安装 SPA 应用（H5）</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/plus/guide/installation/install-spa.html#什么是-spa" class="sidebar-link">什么是 SPA</a></li><li class="sidebar-sub-header"><a href="/plus/guide/installation/install-spa.html#简介" class="sidebar-link">简介</a></li><li class="sidebar-sub-header"><a href="/plus/guide/installation/install-spa.html#下载程序" class="sidebar-link">下载程序</a></li><li class="sidebar-sub-header"><a href="/plus/guide/installation/install-spa.html#安装-node-js" class="sidebar-link">安装 Node.js</a></li><li class="sidebar-sub-header"><a href="/plus/guide/installation/install-spa.html#安装-yarn-依赖管理工具" class="sidebar-link">安装 Yarn 依赖管理工具</a></li><li class="sidebar-sub-header"><a href="/plus/guide/installation/install-spa.html#配置-plus-spa" class="sidebar-link">配置 Plus SPA</a></li><li class="sidebar-sub-header"><a href="/plus/guide/installation/install-spa.html#安装依赖" class="sidebar-link">安装依赖</a></li><li class="sidebar-sub-header"><a href="/plus/guide/installation/install-spa.html#子目录发布-spa" class="sidebar-link">子目录发布 SPA</a></li><li class="sidebar-sub-header"><a href="/plus/guide/installation/install-spa.html#独立域名发布-spa" class="sidebar-link">独立域名发布 SPA</a></li><li class="sidebar-sub-header"><a href="/plus/guide/installation/install-spa.html#github-pages-发布-spa" class="sidebar-link">GitHub pages 发布 SPA</a></li><li class="sidebar-sub-header"><a href="/plus/guide/installation/install-spa.html#plus-程序开启页面跳转" class="sidebar-link">Plus 程序开启页面跳转</a></li></ul></li></ul> </div> <div class="page"> <div class="content"><p>首先纠正一下你们所谓的 <code>H5</code>，H5 是 HTML 5 的缩写，也代表新浏览器技术和标准，例如一些先进浏览所支持的一些 HTML 5 标准 APIs，所以请大家认清事实别出去说 H5，在程序员眼里，听到这么叫真的觉得很 Low B 的！</p> <blockquote><p>主要是不知道概念，很容易装逼失败，尴尬的是你😂</p></blockquote> <h2 id="什么是-spa"><a href="#什么是-spa" aria-hidden="true" class="header-anchor">#</a> 什么是 SPA</h2> <p>单页 Web 应用（single page web application，SPA），就是只有一张 Web 页面的应用。单页应用程序 (SPA) 是加载单个 HTML 页面并在用户与应用程序交互时动态更新该页面的Web应用程序。浏览器一开始会加载必需的 HTML、CSS 和 JavaScript，所有的操作都在这张页面上完成，都由 JavaScript 来控制。因此，对单页应用来说模块化的开发和设计显得相当重要。</p> <p>说明参考：</p> <ul><li><a href="https://baike.baidu.com/item/SPA/17536313" target="_blank" rel="noopener noreferrer">SPA · 百度百科<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://zh.wikipedia.org/wiki/%E5%8D%95%E9%A1%B5%E5%BA%94%E7%94%A8" target="_blank" rel="noopener noreferrer">单页应用 · 维基百科<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h2 id="简介"><a href="#简介" aria-hidden="true" class="header-anchor">#</a> 简介</h2> <p>Plus 小屏网页客户端（以下简称 Plus SPA）是使用 Vue.js 及 ES+ 等现代 Web 技术进行构建编写的 Web 单页应用。其纯前端的代码，允许将 Plus SPA 分发到网络上的各个地方，甚至你可以进行设备嵌入本地运行，只要你有一个可以渲染 JS + HTML + CSS 的应用即可。</p> <h2 id="下载程序"><a href="#下载程序" aria-hidden="true" class="header-anchor">#</a> 下载程序</h2> <p>在前面的教程中，我们在 <strong>CentOS</strong> <code>7.4</code> 的服务器中已经安装可 Git 软件，如果你是直接跳过来看 SPA 安装教程的，请在 CentOS 中运行下面的命令安装，如果你不是 CentOS 系统，请自行从 Git 官网安装，命令如下：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>yum <span class="token function">install</span> -y <span class="token function">git</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>我们的 SPA 代码存放在👉「<a href="https://github.com/slimkit/plus-small-screen-client" target="_blank" rel="noopener noreferrer">slimkit/plus-small-screen-client<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>」。</p> <p>现在，我们进入 CentOS 中，然后按照之前安装 Plus 的惯例，我们将程序代码存放在 <code>/usr/local/src</code> 目录中，所以我们执行 <code>cd /usr/local/src</code> 即可进入该目录，然后我们执行下面的命令：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> clone https://github.com/slimkit/plus-small-screen-client spa <span class="token operator">&amp;&amp;</span> <span class="token function">cd</span> spa
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>执行完成你，你可以执行 <code>pwd</code> 你可以看到你当前所处的位置为 <code>/usr/local/src/spa</code>，这就是我们的代码位置了。</p> <h2 id="安装-node-js"><a href="#安装-node-js" aria-hidden="true" class="header-anchor">#</a> 安装 Node.js</h2> <p>我们打开 <a href="https://nodejs.org/en/download/" target="_blank" rel="noopener noreferrer">Node.js 官网下载页面<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 默认会选择 LTS 版本，目前我这里最新的是 <code>8.12.0</code> 版本，我们在页面找到 ·Linux Binaries (x86/x64)· 这一行，我这里系统是 <code>65 Bit</code> 所以我点击这一行的 <code>64-bit</code> 按钮，你更具你系统选择。如果你不清楚，请看下图：</p> <img src="/plus/assets/img/guide/installation/node-js-download-page.png"> <p>通过上图可知，我这里需要 <code>64-bit</code> 右键后选择「复制链接地址」得到 <code>https://nodejs.org/dist/v8.12.0/node-v8.12.0-linux-x64.tar.xz</code> 这样的地址。我们现在回到服务器家目录（执行 <code>cd ~</code>）然后使用下面的命令进行下载：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">curl</span> -L https://nodejs.org/dist/v8.12.0/node-v8.12.0-linux-x64.tar.xz <span class="token operator">&gt;</span> node-v8.12.0-linux-x64.tar.xz
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>执行完成后，我们输入 <code>ls -al</code> 命令，你会看到有一个 <code>node-v8.12.0-linux-x64.tar.xz</code> 的归档文件。</p> <p>现在我们下载解压工具对归档进行解压：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>yum <span class="token function">install</span> -y xz <span class="token function">tar</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>执行完成后，我们开始解压吧！我们先执行 <code>xz -d node-v8.12.0-linux-x64.tar.xz</code> 命令，然后之前的 <code>.xz</code> 归档消失了，会多处一个 <code>node-v8.12.0-linux-x64.tar</code> 的归档文件，我们继续执行 <code>tar -xvf node-v8.12.0-linux-x64.tar</code> 就会出现一个 <code>node-v8.12.0-linux-x64</code> 的文件夹，这就是我们的 Node.js 程序了！</p> <p>接下来，我们为了统一管理，我们将 Node 软件放到指定位置（并不是必须，而是推荐），之前我们的软件都放在 <code>/usr/local</code> 下，所以这次也一样，我们执行：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">mv</span> -f ~/node-v8.12.0-linux-x64 /usr/local/node
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>然后为了方便我们全局使用 <code>node</code> 命令进行调用，我们需要将 <code>/usr/local/node/bin</code> 加入到环境变量，素以我们使用 Vim 打开 <code>/etc/profile</code> 文件，在结尾追加一行：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">export</span> PATH<span class="token operator">=</span><span class="token variable">$PATH</span>:/usr/local/node/bin/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>加入后，我们执行 <code>source /etc/profile</code> 使其生效，最后我们输入 <code>node -v</code> 你会看到下面的信息，表示已经成功：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>v8.12.0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="安装-yarn-依赖管理工具"><a href="#安装-yarn-依赖管理工具" aria-hidden="true" class="header-anchor">#</a> 安装 Yarn 依赖管理工具</h2> <p>我们并不推荐使用 NPM 进行依赖管理，因为开发人员在开发过程中也是重度依赖 Yarn 进行依赖管理，我们并不知道开发人员会搞出什么幺蛾子，所以我们和开发人员一样使用 Yarn 吧！常规安装 Yarn 较为麻烦，但是我们可以利用 NPM <strong>让媳妇把小三抱进家里</strong>☺️：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> -g i yarn
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>接下来，我们运行 <code>yarn --version</code> 就会输出 Yarn 的版本信息，说明我们已经安装完成了。</p> <h2 id="配置-plus-spa"><a href="#配置-plus-spa" aria-hidden="true" class="header-anchor">#</a> 配置 Plus SPA</h2> <p>好了，工具和环境都安装完成了，我们输入 <code>cd /usr/local/src/spa</code> 回到 Plus SPA 的代码目录，运行下面的命令，创建我们所需要的 <code>.env</code> 文件：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">cat</span> .env.example <span class="token operator">&gt;</span> .env
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>运行完成后，我们使用 Vim 工具进行编辑该文件，运行 <code>vim .env</code> 命令，找到并编辑以下内容：</p> <div class="language-ini line-numbers-mode"><pre class="language-ini"><code><span class="token constant">BASE_URL</span><span class="token attr-value"><span class="token punctuation">=</span>/ # 我们假设你部署在一个域名下，所以默认 `/`, 例如你部署在子目录下，请设置子目录，必须以 `/` 结尾！</span>
<span class="token constant">VUE_APP_API_HOST</span><span class="token attr-value"><span class="token punctuation">=</span>http://127.0.0.1 # 将内容修改为我们服务器的 IP 地址（上一章我们使用 NPM + FPM 发布了站点的）</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><blockquote><p>各个参数描述详情清查看 <a href="https://github.com/slimkit/plus/blob/master/resources/spa/.env.example" target="_blank" rel="noopener noreferrer">plus/resource/spa/.env.example<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 的描述</p></blockquote> <h2 id="安装依赖"><a href="#安装依赖" aria-hidden="true" class="header-anchor">#</a> 安装依赖</h2> <p>我们使用 <code>cd /usr/local/src/spa</code> 进入 Plus SPA 程序目录，这里我们使用 Yarn 工具进行程序的依赖安装：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>yarn <span class="token function">install</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><blockquote><p>这个过程会从国外的服务器上下载依赖包的元数据和依赖包数据，所以速度会很慢，因为 <code>vue-cli</code> 工具本身的依赖原因，过程中会出现一些 <code>warning</code> 开头的警告，这不是错误，所以无需理会！</p></blockquote> <h2 id="子目录发布-spa"><a href="#子目录发布-spa" aria-hidden="true" class="header-anchor">#</a> 子目录发布 SPA</h2> <p>子目录发布 H5 有一个不好的地方，就是我们只能使用 <code>hash</code> 模式理由，但是我们可以规避<strong>跨域请求</strong>的安全限制问题，当然，想使用 <code>history</code> 需要对 Nginx 做特殊处理，这里教程中并不会给出例子，因为我们后面有独立部署的章节，所以我们先来看如何子目录安装吧。</p> <p>首先<strong>我们拟定我们希望放置在 Plus 程序域名下的 <code>spa</code> 目录下</strong>，所以，我们重新打开 Plus SPA 的 .env 文件，然后将下面的 <code>BASE_URL</code> 修改为 <code>/spa/</code> 这个值，修改后应该是这样的：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>BASE_URL=/spa/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>修改成功后，我们使用 <code>cd /usr/local/src/spa</code> 命令进入 Plus SPA 程序目录，然后执行虾米啊的命令进行打包编译：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>yarn build
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>这个过程也是比较慢的，速度取决于你的磁盘速度。运行成功后会有类似下面的输出：</p> <img src="/plus/assets/img/guide/installation/build-spa-console-output.png"> <p>接下来我们执行下面的命令，将其编译好的输出软链到我们的 Plus 程序的 public 下：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>ln -s /usr/local/src/spa/dist /usr/local/src/plus/public/spa
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><blockquote><p>如果你不用软链，你可以将 <code>/usr/local/src/spa/dist</code> 里面的内容全部复制到 <code>/usr/local/src/plus/public/spa</code> 目录下。</p></blockquote> <p>然后我们现在打开你的网站，后面输入 <code>/spa</code> 查看 H5 吧！大概的样子如下：</p> <img src="/plus/assets/img/guide/installation/local-dir-publish-spa-review.png"> <p>注意点：</p> <ol><li>为防止在 History 模式下刷新页面出现 <code>404</code> 错误，需要在 nginx.conf 的相应配置地方追加对于 SPA 的 URL 重写机制。其中 <code>/spa</code> 是你的相对域名根目录的路径，工作目录以 <code>/usr/local/src/plus/public/spa</code> 为例，相应配置类似于：</li></ol> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token keyword">location</span> <span class="token operator">/</span>spa <span class="token punctuation">{</span>
   <span class="token keyword">alias</span> <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>src<span class="token operator">/</span>plus<span class="token operator">/</span>public<span class="token operator">/</span>spa<span class="token punctuation">;</span>
   <span class="token keyword">index</span> <span class="token keyword">index</span><span class="token punctuation">.</span>html<span class="token punctuation">;</span>
   <span class="token keyword">try_files</span> <span class="token variable">$uri</span> <span class="token variable">$uri</span><span class="token operator">/</span> <span class="token operator">/</span><span class="token keyword">index</span><span class="token punctuation">.</span>html<span class="token operator">?</span><span class="token variable">$query_string</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token operator">-</span>e <span class="token variable">$request_filename</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
       <span class="token keyword">rewrite</span> <span class="token operator">^</span><span class="token operator">/</span>spa<span class="token operator">/</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">)</span>$ <span class="token operator">/</span>spa<span class="token operator">/</span><span class="token keyword">index</span><span class="token punctuation">.</span>html<span class="token operator">?</span>s<span class="token operator">=</span>$<span class="token number">1</span> last<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="独立域名发布-spa"><a href="#独立域名发布-spa" aria-hidden="true" class="header-anchor">#</a> 独立域名发布 SPA</h2> <p>我们在前面的教程中安装了 Nginx 这一节教程将指导如何在独立域名（或者端口）进行程序的发布，因为这里是教程，我们就换一个网络端口（因为 <code>80</code> 端口已经被 Plus 程序占用）进行发布。</p> <p>我们使用 <code>touch /usr/local/nginx/vhost/spa.conf</code> 命令创建配置文件，然后编辑该文件，内容如下：</p> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token keyword">server</span> <span class="token punctuation">{</span>
    <span class="token keyword">listen</span> <span class="token number">8080</span><span class="token punctuation">;</span> <span class="token comment"># 因为 80 端口被占用了，所以我们使用 8080 端口</span>
    <span class="token keyword">server_name</span> localhost<span class="token punctuation">;</span> <span class="token comment"># 如果你已经为 SPA 分配了域名，那么将这路的 `localhost` 替换为域名，然后 listen 可以继续使用 80 端口！</span>
    <span class="token keyword">root</span> <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>src<span class="token operator">/</span>spa<span class="token operator">/</span>dist<span class="token punctuation">;</span>
    <span class="token keyword">index</span> <span class="token keyword">index</span><span class="token punctuation">.</span>html<span class="token punctuation">;</span>

    <span class="token keyword">location</span> <span class="token operator">/</span> <span class="token punctuation">{</span>
        <span class="token keyword">try_files</span> <span class="token variable">$uri</span> <span class="token variable">$uri</span><span class="token operator">/</span> <span class="token operator">/</span><span class="token keyword">index</span><span class="token punctuation">.</span>html<span class="token variable">$is_args</span><span class="token variable">$args</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>接下来，我们使用 <code>cd /usr/local/src/spa</code> 进入 Plus SPA 目录，编辑下面的 <code>.env</code> 文件，将 <code>BASE_URL</code> 的值修改为 <code>/</code> 修改后的样子：<code>BASE_URL=/</code> 这样子。将 <code>VUE_APP_ROUTER_MODE</code> 的值替换为 <code>history</code> 修改后的样子：<code>VUE_APP_ROUTER_MODE=history</code>。</p> <p>然后我们执行 <code>yarn build</code> 命令，等待命令执行完成。命令执行完成后，我们使用 <code>nginx -s reload</code> 命令重新加载 Nginx 配置。</p> <p>然后我们在浏览器打开 <code>http://你的ip:8080</code> 看到类似于「子目录发布的站点了」。</p> <h2 id="github-pages-发布-spa"><a href="#github-pages-发布-spa" aria-hidden="true" class="header-anchor">#</a> GitHub pages 发布 SPA</h2> <p>首先，你需要一个 GitHub 帐号，你可以任意创建一个空白仓库（打开网址 <a href="https://github.com/new" target="_blank" rel="noopener noreferrer">https://github.com/new<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>），创建仓库如下截图：</p> <img src="/plus/assets/img/guide/installation/new-a-github-repo.png"> <blockquote><p>「Initialize this repository with a README」 一定要勾选上，因为看这个教程按照零基础进行，如果不勾选，会多处很多后续步骤，这个你们就自己学了 Git 命令自己探索吧！</p></blockquote> <p>接下来，我们使用 <code>cd /usr/local/src/spa</code> 进入 Plus SPA 目录，编辑下面的 <code>.env</code> 文件，将 <code>BASE_URL</code> 的值修改为 <code>仓库名字</code> 修改后的样子：<code>BASE_URL=/spa/</code> (这里的值之所以是 <code>/spa/</code> 是因为我们仓库名字叫做 <code>spa</code>) 这样子。将 <code>VUE_APP_ROUTER_MODE</code> 的值替换为 <code>history</code> 修改后的样子：<code>VUE_APP_ROUTER_MODE=history</code>。</p> <p>然后我们执行 <code>yarn build</code> 命令，执行完成后，我们得到了 <code>dist</code> 的文件，然后将里面的内容上传到你创建仓库的 <code>gh-pages</code> 分支中。访问 <code>https://&lt;USERNAME&gt;.github.io/&lt;REPO&gt;</code>。</p> <blockquote><p><code>&lt;USERNAME&gt;</code> 是你的 GitHub 用户名，<code>&lt;REPO&gt;</code> 是你的仓库名称。</p></blockquote> <h2 id="plus-程序开启页面跳转"><a href="#plus-程序开启页面跳转" aria-hidden="true" class="header-anchor">#</a> Plus 程序开启页面跳转</h2> <p>我们现在打开 Plus 程序的后台页面，然后点击「系统设置」在「基本信息」蓝中下拉，找到 「Web 终端」的设置版。首先我们在第二项的的地方输入 SPA 地址，输入后开关按钮变为可操作状态，然后点击开启，最后点击提交即可！截图如下：</p> <img src="/plus/assets/img/guide/installation/spa-set-web-client-url.png"></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/slimkit/plus/edit/docs/guide/installation/install-spa.md" target="_blank" rel="noopener noreferrer">协助改善此文档</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">更新时间: </span> <span class="time">12/12/2018, 8:23:57 AM</span></div></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/plus/guide/installation/using-nginx-and-fpm-publish-website.html" class="prev">
          使用 Nginx + FPM 发布站点
        </a></span> <!----></p></div> </div> <!----></div></div>
    <script src="/plus/assets/js/app.d5d27418.js" defer></script><script src="/plus/assets/js/15.a1f97495.js" defer></script>
  </body>
</html>
